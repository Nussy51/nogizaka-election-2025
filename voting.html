<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>乃木坂総選挙2025｜投票フォーム</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: "Helvetica Neue", sans-serif;
      background-color: #f8f8f8;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #5c2d91;
      margin-bottom: 30px;
    }

    form {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 700px;
      margin: 0 auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }

    select, textarea, button {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    .member-list {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 15px;
    }

    .member-item {
      flex: 1 1 calc(50% - 12px);
      display: flex;
      align-items: center;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 8px;
      background: #fafafa;
    }

    .member-item input[type="radio"] {
      margin-right: 10px;
      transform: scale(1.2);
    }

    .member-item img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 6px;
      margin-right: 10px;
    }

    .member-name {
      font-size: 16px;
      font-weight: 500;
    }

    button {
      background-color: #5c2d91;
      color: white;
      font-weight: bold;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: #452079;
    }

    @media (max-width: 600px) {
      .member-item {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>
  <h1>乃木坂総選挙2025 投票フォーム</h1>
  <form id="voteForm">
    <label for="generation">期を選択</label>
    <select id="generation" required>
      <option value="">--選んでください--</option>
      <option value="3期生">3期生</option>
      <option value="4期生">4期生</option>
      <option value="5期生">5期生</option>
      <option value="6期生">6期生</option>
    </select>

    <div id="memberContainer" class="member-list"></div>

    <label for="reason">推しポイント（必須）</label>
    <textarea id="reason" rows="4" required placeholder="あなたの熱い思いをここに..."></textarea>

    <button type="submit">投票する</button>
  </form>

  <script>
    const members = {
      "3期生": [
        { name: "伊藤理々杏", img: "images/members/IMG_0188.JPG" },
        { name: "岩本蓮加", img: "images/members/IMG_0190.JPG" },
        { name: "梅澤美波", img: "images/members/IMG_0191.JPG" },
        { name: "久保史緒里", img: "images/members/IMG_0199.JPG" },
        { name: "吉田綾乃クリスティー", img: "images/members/IMG_0212.JPG" }
      ],
      "4期生": [
        { name: "遠藤さくら", img: "images/members/IMG_0192.JPG" },
        { name: "賀喜遥香", img: "images/members/IMG_0196.JPG" },
        { name: "金川紗耶", img: "images/members/IMG_0197.JPG" },
        { name: "黒見明香", img: "images/members/IMG_0200.JPG" },
        { name: "佐藤璃果", img: "images/members/IMG_0201.JPG" },
        { name: "柴田柚菜", img: "images/members/IMG_0202.JPG" },
        { name: "田村真佑", img: "images/members/IMG_0204.JPG" },
        { name: "筒井あやめ", img: "images/members/IMG_0205.JPG" },
        { name: "林瑠奈", img: "images/members/IMG_0208.JPG" },
        { name: "松尾美佑", img: "images/members/IMG_0209.JPG" },
        { name: "矢久保美緒", img: "images/members/IMG_0210.JPG" },
        { name: "弓木奈於", img: "images/members/IMG_0211.JPG" }
      ],
      "5期生": [
        { name: "五百城茉央", img: "images/members/IMG_0185.JPG" },
        { name: "池田瑛紗", img: "images/members/IMG_0186.JPG" },
        { name: "一ノ瀬美空", img: "images/members/IMG_0187.JPG" },
        { name: "井上和", img: "images/members/IMG_0189.JPG" },
        { name: "岡本姫奈", img: "images/members/IMG_0193.JPG" },
        { name: "小川彩", img: "images/members/IMG_0194.JPG" },
        { name: "奥田いろは", img: "images/members/IMG_0195.JPG" },
        { name: "川﨑桜", img: "images/members/IMG_0198.JPG" },
        { name: "菅原咲月", img: "images/members/IMG_0203.JPG" },
        { name: "冨里奈央", img: "images/members/IMG_0206.JPG" },
        { name: "中西アルノ", img: "images/members/IMG_0207.JPG" }
      ],
      "6期生": [
        { name: "愛宕心響", img: "images/members/IMG_0213.JPG" },
        { name: "大越ひなの", img: "images/members/IMG_0214.JPG" },
        { name: "小津玲奈", img: "images/members/IMG_0215.JPG" },
        { name: "海邉朱莉", img: "images/members/IMG_0216.JPG" },
        { name: "川端晃菜", img: "images/members/IMG_0217.JPG" },
        { name: "鈴木佑捺", img: "images/members/IMG_0218.JPG" },
        { name: "瀬戸口心月", img: "images/members/IMG_0219.JPG" },
        { name: "長嶋凛桜", img: "images/members/IMG_0220.JPG" },
        { name: "増田三莉音", img: "images/members/IMG_0221.JPG" },
        { name: "森平麗心", img: "images/members/IMG_0222.JPG" },
        { name: "矢田萌華", img: "images/members/IMG_0223.JPG" }
      ]
    };

    const generationSelect = document.getElementById("generation");
    const memberContainer = document.getElementById("memberContainer");

    generationSelect.addEventListener("change", () => {
      const selectedGen = generationSelect.value;
      memberContainer.innerHTML = "";

      if (members[selectedGen]) {
        members[selectedGen].forEach((member) => {
          const memberDiv = document.createElement("label");
          memberDiv.className = "member-item";

          memberDiv.innerHTML = 
            <input type="radio" name="member" value="${member.name}" required />
            <img src="${member.img}" alt="${member.name}">
            <span class="member-name">${member.name}</span>
          ;

          memberContainer.appendChild(memberDiv);
        });
      }
    });

    document.getElementById("voteForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const member = document.querySelector("input[name='member']:checked");
      const reason = document.getElementById("reason").value.trim();

      if (!member || !reason) {
        alert("すべての項目を入力してください。");
        return;
      }

      alert("投票ありがとうございました！");
      this.reset();
      memberContainer.innerHTML = "";
    });
<script>
  const members = {
    /* 省略：membersデータはそのまま */
  };

  const generationSelect = document.getElementById("generation");
  const memberContainer = document.getElementById("memberContainer");

  generationSelect.addEventListener("change", () => {
    const selectedGen = generationSelect.value;
    memberContainer.innerHTML = "";

    if (members[selectedGen]) {
      members[selectedGen].forEach((member) => {
        const memberDiv = document.createElement("label");
        memberDiv.className = "member-item";

        memberDiv.innerHTML = `
          <input type="radio" name="member" value="${member.name}" required />
          <img src="${member.img}" alt="${member.name}">
          <span class="member-name">${member.name}</span>
        `;

        memberContainer.appendChild(memberDiv);
      });
    }
  });

  document.getElementById("voteForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const generation = document.getElementById("generation").value;
    const member = document.querySelector("input[name='member']:checked");
    const reason = document.getElementById("reason").value.trim();

    if (!generation || !member || !reason) {
      alert("すべての項目を入力してください。");
      return;
    }

    const payload = new URLSearchParams();
    payload.append('generation', generation);
    payload.append('member', member.value);
    payload.append('reason', reason);

    fetch('https://script.google.com/macros/s/AKfycbxX5OCX3CBvi4cylcOaU2AZXznrc3Fxk2okAxabj--XTuGLS7fdxhMhEe1dKJyhRh_m/exec', {
      method: 'POST',
      body: payload,
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
    })
    .then(res => res.text())
    .then(text => {
      if (text === 'success') {
        alert("投票ありがとうございました！");
        this.reset();
        memberContainer.innerHTML = "";
      } else {
        alert("送信に失敗しました。時間を置いて再度お試しください。");
      }
    })
    .catch(() => alert("通信エラーが発生しました。"));
  });
</script>
</body>
</html>
