<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>乃木坂総選挙2025</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #fdfdfd;
      text-align: center;
      margin: 20px;
    }

    select, button {
      padding: 10px;
      font-size: 16px;
      margin: 10px;
    }

    .members-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .member-card {
      width: 120px;
      cursor: pointer;
      border: 2px solid transparent;
      border-radius: 8px;
      overflow: hidden;
      transition: 0.2s;
    }

    .member-card.selected {
      border-color: #2196f3;
    }

    .member-card img {
      width: 100%;
      height: auto;
    }

    .member-card p {
      margin: 5px 0;
      font-size: 14px;
    }

    .success {
      color: green;
      margin-top: 15px;
    }

    .error {
      color: red;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <h1>乃木坂総選挙2025</h1>

  <label for="generation">期を選択：</label>
  <select id="generation" onchange="showMembers()">
    <option value="">-- 選んでください --</option>
    <option value="3期生">3期生</option>
    <option value="4期生">4期生</option>
    <option value="5期生">5期生</option>
    <option value="6期生">6期生</option>
  </select>

  <form id="vote-form">
    <div id="members" class="members-container"></div>
    <input type="hidden" name="member" id="selected-member" />
    <button type="submit">投票する</button>
    <p class="success" id="success-message"></p>
    <p class="error" id="error-message"></p>
  </form>

  <script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbxX5OCX3CBvi4cylcOaU2AZXznrc3Fxk2okAxabj--XTuGLS7fdxhMhEe1dKJyhRh_m/exec';

    const membersData = {
      '3期生': [
        { name: '伊藤理々杏', image: 'IMG_0188.JPG' },
        { name: '岩本蓮加', image: 'IMG_0190.JPG' },
        { name: '梅澤美波', image: 'IMG_0191.JPG' },
        { name: '久保史緒里', image: 'IMG_0199.JPG' },
        { name: '吉田綾乃クリスティー', image: 'IMG_0212.JPG' }
      ],
      '4期生': [
        { name: '遠藤さくら', image: 'IMG_0192.JPG' },
        { name: '賀喜遥香', image: 'IMG_0196.JPG' },
        { name: '金川紗耶', image: 'IMG_0197.JPG' },
        { name: '黒見明香', image: 'IMG_0200.JPG' },
        { name: '佐藤璃果', image: 'IMG_0201.JPG' },
        { name: '柴田柚菜', image: 'IMG_0202.JPG' },
        { name: '田村真佑', image: 'IMG_0204.JPG' },
        { name: '筒井あやめ', image: 'IMG_0205.JPG' },
        { name: '林瑠奈', image: 'IMG_0208.JPG' },
        { name: '松尾美佑', image: 'IMG_0209.JPG' },
        { name: '矢久保美緒', image: 'IMG_0210.JPG' },
        { name: '弓木奈於', image: 'IMG_0211.JPG' }
      ],
      '5期生': [
        { name: '五百城茉央', image: 'IMG_0185.JPG' },
        { name: '池田瑛紗', image: 'IMG_0186.JPG' },
        { name: '一ノ瀬美空', image: 'IMG_0187.JPG' },
        { name: '井上和', image: 'IMG_0189.JPG' },
        { name: '岡本姫奈', image: 'IMG_0193.JPG' },
        { name: '小川彩', image: 'IMG_0194.JPG' },
        { name: '奥田いろは', image: 'IMG_0195.JPG' },
        { name: '川﨑桜', image: 'IMG_0198.JPG' },
        { name: '菅原咲月', image: 'IMG_0203.JPG' },
        { name: '冨里奈央', image: 'IMG_0206.JPG' },
        { name: '中西アルノ', image: 'IMG_0207.JPG' }
      ],
      '6期生': [
        { name: '愛宕心響', image: 'IMG_0213.JPG' },
        { name: '大越ひなの', image: 'IMG_0214.JPG' },
        { name: '小津玲奈', image: 'IMG_0215.JPG' },
        { name: '海邉朱莉', image: 'IMG_0216.JPG' },
        { name: '川端晃菜', image: 'IMG_0217.JPG' },
        { name: '鈴木佑捺‎‎', image: 'IMG_0218.JPG' },
        { name: '瀬戸口心月', image: 'IMG_0219.JPG' },
        { name: '長嶋凛桜', image: 'IMG_0220.JPG' },
        { name: '増田三莉音', image: 'IMG_0221.JPG' },
        { name: '森平麗心', image: 'IMG_0222.JPG' },
        { name: '矢田萌華', image: 'IMG_0223.JPG' }
      ]
    };

    function showMembers() {
      const generation = document.getElementById('generation').value;
      const membersContainer = document.getElementById('members');
      membersContainer.innerHTML = '';

      if (!generation || !membersData[generation]) return;

      membersData[generation].forEach(member => {
        const card = document.createElement('div');
        card.className = 'member-card';
        card.onclick = () => selectMember(card, member.name);

        const img = document.createElement('img');
        img.src = `images/members/${member.image}`;
        img.alt = member.name;

        const name = document.createElement('p');
        name.textContent = member.name;

        card.appendChild(img);
        card.appendChild(name);
        membersContainer.appendChild(card);
      });
    }

    function selectMember(card, name) {
      document.querySelectorAll('.member-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      document.getElementById('selected-member').value = name;
    }

    document.getElementById('vote-form').addEventListener('submit', function (e) {
      e.preventDefault();
      const member = document.getElementById('selected-member').value;
      const errorMsg = document.getElementById('error-message');
      const successMsg = document.getElementById('success-message');
      errorMsg.textContent = '';
      successMsg.textContent = '';

      if (!member) {
        errorMsg.textContent = 'メンバーを選択してください。';
        return;
      }

      const formData = new FormData();
      formData.append('member', member);

      fetch(GAS_URL, {
        method: 'POST',
        body: formData
      })
        .then(res => res.text())
        .then(data => {
          successMsg.textContent = '投票が完了しました！';
          document.getElementById('selected-member').value = '';
          document.querySelectorAll('.member-card').forEach(c => c.classList.remove('selected'));
        })
        .catch(err => {
          errorMsg.textContent = '投票に失敗しました。時間をおいて再度お試しください。';
        });
    });
  </script>
</body>
</html>

